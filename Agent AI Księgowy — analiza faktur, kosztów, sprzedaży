# Form-to-Sheets ‚Äî agent do zaczytywania faktur do Google Sheets

Agent, kt√≥ry automatycznie zbiera dane z faktur (PDF / skany / zdjƒôcia) i zapisuje je jako uporzƒÖdkowane wiersze w Google Sheets.

---

## 1. Problem

Do firmy regularnie sp≈ÇywajƒÖ **faktury**:

- jako **za≈ÇƒÖczniki w e-mailach** (PDF / JPG),
- jako **pliki / zdjƒôcia wysy≈Çane na Telegramie**.

Kto≈õ musi rƒôcznie:

- pobraƒá za≈ÇƒÖcznik,
- odczytaƒá dane z faktury,
- przepisaƒá je do arkusza (np. rejestru VAT / koszt√≥w),
- zapisaƒá plik w odpowiednim folderze na Google Drive.

To zajmuje czas, jest podatne na b≈Çƒôdy i trudno to skalowaƒá przy wiƒôkszej liczbie dokument√≥w.

---

## 2. RozwiƒÖzanie (agent)

Stworzy≈Çem agenta w **n8n**, kt√≥ry:

1. Odbiera wiadomo≈õci:
   - z **Gmaila** (nowe e-maile z fakturami w za≈ÇƒÖczniku),
   - z **Telegrama** (nowe pliki / zdjƒôcia faktur).
2. Zapisuje faktury na **Google Drive** we w≈Ça≈õciwym katalogu.
3. U≈ºywa **OpenAI (Vision + Information Extractor)** do:
   - odczytania tre≈õci faktury z PDF/obrazu,
   - wyciƒÖgniƒôcia konkretnych p√≥l, np.:
     - numer faktury,
     - data wystawienia,
     - data sprzeda≈ºy,
     - kontrahent (nazwa),
     - NIP,
     - kwota netto / VAT / brutto,
     - forma p≈Çatno≈õci,
     - termin p≈Çatno≈õci.
4. Zapisuje dane jako **nowy wiersz** w **Google Sheets** (np. rejestr faktur).
5. (Opcjonalnie) Mo≈ºe odes≈Çaƒá podsumowanie / potwierdzenie przez e-mail lub Telegram.

Efekt: ca≈Çy proces **od faktury do wiersza w arkuszu** jest zautomatyzowany.

---

## 3. Architektura

### Workflow w n8n

> (Screen zostanie dodany jako `workflow.png`)

G≈Ç√≥wne elementy scenariusza:

- **Gmail Trigger** ‚Äì reaguje na nowe e-maile z fakturami.
- **Telegram Trigger** ‚Äì reaguje na nowe wiadomo≈õci z fakturami (plik/zdjƒôcie).
- **Filtry** ‚Äì przepuszczajƒÖ tylko wiadomo≈õci z za≈ÇƒÖcznikami.
- **Zapisywanie plik√≥w na Google Drive** (np. wg roku/miesiƒÖca).
- **Loop Over Items** ‚Äì przetwarza ka≈ºdƒÖ fakturƒô osobno.
- **OpenAI (Vision + Information Extractor)** ‚Äì odczyt i ekstrakcja danych z faktury.
- **Google Sheets** ‚Äì dopisanie nowego wiersza z danymi faktury.
- (Opcjonalnie) **Gmail / Telegram** ‚Äì wysy≈Çka podsumowania.

**Stack technologiczny:**

- n8n (self-hosted)
- Gmail API
- Telegram Bot API
- Google Drive + Google Sheets
- OpenAI (Chat/Agents + Vision)

---

## 4. Przep≈Çyw krok po kroku

1. U≈ºytkownik otrzymuje fakturƒô:
   - jako za≈ÇƒÖcznik w e-mailu **lub**
   - jako plik / zdjƒôcie na Telegramie.
2. Agent zapisuje fakturƒô na **Google Drive** w odpowiednim katalogu (np. `Faktury/2025/11`).
3. OpenAI odczytuje tre≈õƒá faktury i zamienia jƒÖ na ustrukturyzowane dane (JSON).
4. Dane trafiajƒÖ jako **nowy wiersz** do **Google Sheets**:
   - ka≈ºda kolumna to jedno pole faktury (np. data, numer, NIP, kwoty).
5. Plik ≈∫r√≥d≈Çowy (faktura) jest bezpiecznie przechowywany na Google Drive i mo≈ºna go ≈Çatwo odnale≈∫ƒá.

---

## 5. Efekt biznesowy

- ‚è± **Oszczƒôdno≈õƒá czasu** ‚Äì brak rƒôcznego przepisywania danych z faktur.
- ‚úÖ **Mniej b≈Çƒôd√≥w** ‚Äì ustandaryzowany format danych, mniej pomy≈Çek w kwotach/NIP-ach.
- üìä **Dane od razu gotowe do analizy** ‚Äì mo≈ºna robiƒá raporty koszt√≥w, cashflow, VAT itd.
- üßæ **Lepszy porzƒÖdek w dokumentach** ‚Äì faktury sƒÖ zapisane w jednym systemie (Drive + Sheets).
- üîÅ **Skalowalno≈õƒá** ‚Äì ≈Çatwo dodaƒá kolejne skrzynki mailowe, kana≈Çy czy typy faktur.

---

## 6. Jak uruchomiƒá (wysoki poziom)

> Uwaga: to portfolio, nie gotowy produkt ‚Äûone-click install‚Äù. Poni≈ºej opis krok√≥w wdro≈ºenia.

1. Zainstaluj i uruchom **n8n** (np. w Dockerze).
2. Skonfiguruj integracje:
   - konto **Gmail** (OAuth / API),
   - **bota Telegram**,
   - dostƒôp do **Google Drive** i **Google Sheets**,
   - klucz API **OpenAI**.
3. Zaimportuj workflow z pliku `workflow.json`.
4. Ustaw zmienne ≈õrodowiskowe zgodnie z `env.example` (np. ID arkusza, ID folderu na Drive).
5. W≈ÇƒÖcz workflow i przetestuj na przyk≈Çadowych fakturach w r√≥≈ºnych formatach.

---

## 7. Pliki w tym folderze

- `README.md` ‚Äì opis agenta (ten plik),
- `workflow.json` ‚Äì eksport scenariusza n8n,
- `env.example` ‚Äì przyk≈Çadowa konfiguracja zmiennych ≈õrodowiskowych,
- `workflow.png` ‚Äì screen workflow z n8n,
- `demo.gif` ‚Äì (opcjonalnie) kr√≥tka demonstracja dzia≈Çania agenta,
- `sheet.png` ‚Äì (opcjonalnie) przyk≈Çad wype≈Çnionego arkusza Google z danymi faktur.
